apiVersion: blueprints.cloud.google.com/v1alpha1
kind: BlueprintMetadata
metadata:
  name: terraform-gcp-gridgain9
  annotations:
    config.kubernetes.io/local-config: "true"
spec:
  info:
    title: GridGain9 Terraform Module for GCP
    source:
      repo: https://github.com/gridgain/terraform-gcp-gridgain9.git
      sourceType: git
    description: {}
  content:
    examples:
      - name: example
        location: examples/example
      - name: example_with_ssl
        location: examples/example_with_ssl
  interfaces:
    variables:
      - name: project_id
        description: GCP project ID where resources will be provisioned.
        varType: string
        required: true
      - name: goog_cm_deployment_name
        description: The deployment name generated by Google Cloud Marketplace.
        varType: string
        required: true
      - name: region
        description: GCP deployment region
        varType: string
        defaultValue: us-east1
      - name: zones
        description: List of zones to use (first element used for singleâ€‘node)
        varType: list(string)
        defaultValue:
          - us-east1-b
          - us-east1-c
      - name: nodes_count
        description: Number of GG9 nodes. 1 = single node
        varType: number
        defaultValue: 1
      - name: name_prefix
        description: Name prefix to be used for all resources
        varType: string
        defaultValue: gridgain9db
      - name: machine_type
        description: GCP machine type
        varType: string
        defaultValue: e2-medium
      - name: source_image
        description: The image name for the disk for the VM instance.
        varType: string
        defaultValue: projects/gridgain-public/global/images/vmi-gridgain-db-9-1-5-byol-0-0-1-9
      - name: enable_project_oslogin
        description: Allow OS Login at project level
        varType: bool
        defaultValue: false
      - name: enable_oslogin
        description: Enable OS Login to compute instance
        varType: bool
        defaultValue: true
      - name: enable_logging
        description: Enable Google Cloud Logging
        varType: bool
        defaultValue: true
      - name: enable_monitoring
        description: Enable Google Cloud Monitoring
        varType: bool
        defaultValue: true
      - name: oslogin_access_principals
        description: "List of principals that are granted access via IAP and SSH. Or leave blank to take the current user. Examples: user:alice@example.com, group:devops@example.com, serviceAccount:sa@project.iam.gserviceaccount.com"
        varType: list(string)
        defaultValue: []
      - name: ssh_pub_key
        description: SSH public key used to connect to instances (algorithm + public key). If empty, none will be provisioned
        varType: string
        defaultValue: ""
      - name: root_disk_size_gb
        description: Boot disk size in GB
        varType: number
        defaultValue: 128
      - name: root_disk_type
        description: Boot disk size type
        varType: string
        defaultValue: pd-balanced
      - name: root_disk_throughput
        description: Root disk throughput in MB/s
        varType: number
      - name: root_disk_iops
        description: Amount of provisioned IOPS for root disk
        varType: number
      - name: vpc_id
        description: ID of an existing VPC network to attach
        varType: string
        defaultValue: ""
      - name: subnet_id
        description: Subnet ID to be used for deployment. If empty, module should provision new subnets
        varType: string
        defaultValue: ""
      - name: subnet_cidr
        description: CIDR for private subnet
        varType: string
        defaultValue: 10.0.0.0/24
      - name: public_access_enable
        description: Whether to assign external IPs to instances
        varType: bool
        defaultValue: false
      - name: public_allowlist
        description: CIDR allow list for public subnet
        varType: list(string)
        defaultValue:
          - 0.0.0.0/0
      - name: gridgain_config
        description: GridGain config
        varType: string
        defaultValue: ""
      - name: gridgain_logging_config
        description: GridGain logging config
        varType: string
        defaultValue: ""
      - name: gridgain_license
        description: GridGain license
        varType: string
        defaultValue: ""
      - name: gridgain_ssl_enable
        description: Whether SSL should be enabled
        varType: bool
        defaultValue: false
      - name: gridgain_ssl_cert
        description: "GridGain SSL certificate. Important: The certificate must be issued for the domain zone that will be specified in gridgain_cluster_dns variable"
        varType: string
        defaultValue: ""
      - name: gridgain_ssl_key
        description: GridGain SSL key
        varType: string
        defaultValue: ""
      - name: gridgain_cluster_dns
        description: GridGain Cluster DNS (FQDN)
        varType: string
        defaultValue: ""
      - name: keystore_password
        description: SSL Keystore password
        varType: string
        defaultValue: ""
      - name: enable_disk_encryption
        description: Enable disk encryption using KMS keys
        varType: bool
        defaultValue: false
      - name: kms_location
        description: KMS location
        varType: string
        defaultValue: us-east1
      - name: kms_key_ring_id
        description: KMS keyring id
        varType: string
        defaultValue: ""
      - name: kms_crypto_key_id
        description: KMS crypto key in keyring
        varType: string
        defaultValue: ""
    outputs:
      - name: cluster_dns
        description: Gridgain Cluster FQDN
      - name: instance_ids
        description: List of compute instance IDs
      - name: instance_links
        description: List of compute instance self links
      - name: instance_status
        description: List of instance status
      - name: kms_key_id
        description: KMS key id used for encryption
      - name: kms_keyring_id
        description: KMS keyring id used for encryption
      - name: oslogin_connect_commands
        description: The gcloud CLI command to connect to the compute instance using OSLogin
      - name: private_ips
        description: List of private IP addresses assigned to the instances
      - name: public_ips
        description: List of public IP addresses assigned to the instances
      - name: service_account
        description: Service Account ID
      - name: subnet_id
        description: ID of the created subet
      - name: vpc_id
        description: ID of the created/provided subnet
